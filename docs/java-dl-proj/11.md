

# 十一、讨论、当前趋势和展望

深度神经网络是**深度学习** ( **DL** )的核心，它允许由多个处理层组成的计算模型学习具有多个抽象级别的数据表示。这些方法极大地改善了语音识别、多媒体(图像/音频/视频)分析、NLP、图像处理和分割、视觉对象识别、对象检测以及生命科学中许多其他领域的最新技术，如癌症基因组学、药物发现、个性化医疗和生物医学成像。

在本书中，我们看到了如何使用基于 JVM 的 DL 库来开发涵盖这些领域的应用程序。我承认有些项目不是很全面，不能进行商业部署，但是需要一些额外的努力。尽管如此，展示如何部署这样的模型并不在本书的范围之内。然而，至少这些应该为我们提供一些核心的见解。

现在，我们已经结束了使用不同 Java 库进行深度学习的小小旅程，是时候总结一下了。但在此之前，在这一章中，我们将讨论已完成的项目和一些抽象的要点。然后我们会提供一些改进的建议。此外，我们将涵盖其他真实深度学习项目的一些扩展指南。总之，本章将涵盖以下主题:

*   关于项目、前景、未来改进和扩展的讨论
*   有监督和无监督深度学习算法的当前趋势
*   常见问题(FAQ)



# 讨论和展望

在本书中，我们已经讨论了 10 个端到端项目。我们以深度学习的介绍开始了我们的旅程，并以基于因式分解机的电影推荐系统项目结束。在这一节中，我们将简要回顾这些项目，讨论潜在的限制，并提供一些未来改进和扩展的方向。



# 对已完成项目的讨论

在此期间，我们试图涵盖来自不同领域的几个真实项目，如医疗保健、NLP 中的情感分析、迁移学习、图像和视频分类、分布式深度学习和培训、强化学习、在线交易和视频中的真实对象检测。这些概述如下:

*   使用 MLP 和 LSTM 网络的泰坦尼克号生存预测
*   使用循环类型网络的癌症类型预测
*   基于卷积神经网络的多标签图像分类
*   基于 Word2Vec 和 LSTM 网络的情感分析
*   基于迁移学习的图像分类
*   使用 YOLO、JavaCV 和 DL4J 的实时对象检测
*   基于 LSTM 网络的股票价格预测
*   使用卷积 LSTM 的视频分类的分布式深度学习
*   在 GridWorld 游戏中使用深度强化学习
*   利用因子分解机开发电影推荐系统

现在，我们将讨论改进这些项目的利弊和未来方向，以进行可能的扩展。



# 使用 MLP 和 LSTM 网络的泰坦尼克号生存预测

在这个项目中，我们的主要目标是熟悉 Apache Spark ML 库，其次是对机器学习的基本介绍，深度学习它们的类型、架构和框架。

我们无法达到更高的精确度。然后，在[第 2 章](e27fb252-7892-4659-81e2-2289de8ce570.xhtml)、*使用循环类型网络进行癌症类型预测*中，我们重新考察了相同的项目，但使用了稳健的递归 LSTM 网络，该网络显示出更高的准确性。要点是学习如何通过考虑大多数特征并输入 Spark 和基于 DL4J 的 MLP 分类器来准备数据集。

此外，这个数据集的维数不是很高，因此应用 DL 方法并不是一个好主意。因此，我建议使用其他树集合，如随机森林和梯度增强树进行建模和部署。



# 使用循环类型网络的癌症类型预测

我们解决了一个有趣的项目，我们成功地根据癌症类型对癌症患者进行了分类。为此，我们使用了 LSTM 网络。我们使用了一个非常高维的基因表达数据集。我们将数据集转换为序列格式，并在每个时间步为每个样本训练 LSTM 网络。

该项目还显示了深度架构(如 LSTM)的健壮性，证明了即使不应用降维，该模型也可以处理非常高维的数据集。

这种方法的一个潜在限制是，我们只考虑了基因表达数据集，因此它不能用于现实生活的预后和诊断，而其他数据集，如**拷贝数变异** ( **CNV** )、DNA 甲基化和生存相关的临床结果，也必须考虑。尽管如此，需要生物医学工程师和医生的专业知识来提出一个综合的解决方案。

最后，它至少显示了如何处理至少一种类型的癌症基因组数据集。因此，同样的技术也可以应用于其他数据类型。然后，必须通过在部署之前从领域专家那里获取输入来开发多模态网络，例如人工智能专家系统。



# 基于卷积神经网络的图像分类

在这个项目中，我们看到了如何解决多标签图像分类问题。我们使用了真实的 Yelp 图片。然后，我们训练一个 CNN 来预测每一个标记图像的类别。在这个项目中，最具挑战性的部分是特征工程，因为我们不仅要处理图像，还要处理不同的标签和元数据。不幸的是，我们无法达到非常高的精确度。

结论是类似的方法可以应用于解决具有多标签的其他图像数据集。然而，多类分类问题也可以用最小的努力来解决。您需要做的只是准备数据集，以便基于 CNN 的模型可以使用它。除了这种展望，本项目在[第五章](2d4fc6f2-3753-456c-8774-3f41dbe13cfb.xhtml)、*中使用迁移学习进行图像分类，*可以扩展到解决类似问题。



# 使用 Word2Vec 和 LSTM 网络的情感分析

在这个项目中，我们看到了如何使用 Word2Vec 和 LSTM 开发一个情感分析应用程序。我们还讨论了如何将非结构化文本转换为神经单词嵌入，然后将它们转换为训练 LSTM 网络所需的序列形式。然后，我们用每个时间步的相应文本序列来训练 LSTM。

这个项目还解决了一个非常高精度的二元分类问题。同样，这个应用程序可以扩展到对其他问题进行分类，比如对消息和电子邮件的垃圾邮件与垃圾邮件，以及电影或产品评论。最后，在常见问题部分，我们讨论了如何用 CNN 解决同样的问题，它可以达到与 LSTM 相似的精确度。



# 基于迁移学习的图像分类

在这一章中，我们用迁移学习技术解决了一个有趣的狗和猫的分类问题。我们使用了预训练的 VGG16 模型及其权重，随后我们使用 Kaggle 的真实猫对狗数据集对训练进行了微调。

一旦训练完成，我们保存训练好的模型用于模型持久化和以后的重用。我们看到，经过训练的模型可以成功地检测和区分大小、质量和形状非常不同的猫和狗的图像。

经过训练的模型/分类器可用于解决现实生活中猫和狗的问题。最后，教训是，这种类似的技术与最小的努力，可以扩展和用于解决类似的图像分类问题；这适用于二元和多类分类问题。



# 使用 YOLO、JavaCV 和 DL4J 的实时对象检测

在这个项目中，我们再次使用迁移学习技术来解决另一个有趣的问题，即从视频剪辑中实时检测对象。我们使用预先训练好的 YOLOv2 模型、JavaCV 和 DL4J 库来解决这个问题。

如本章所述，我们扩展了图像识别的思想来解决这个问题。也就是说，我们的技术将视频帧生成为图像，然后使用边界框方法从帧中识别对象。外卖是，虽然我们用了一个视频剪辑来展示评价，但它仍然表现出非常好的准确性。从提供的演示中，任何人都可以观察到剪辑中的大多数对象都被准确地识别出来。因此，类似的技术可以扩展用于实时对象检测。

在这方面，我们看到了一些技巧，可以从网络摄像头或摄像机(甚至手机)收集实时视频，并使用 JavaCV 库将它们输入到我们的 YOLOv2 模型中。



# 基于 LSTM 网络的股票价格预测

在这个项目中，我们看到了如何开发一个演示项目来预测五个类别的股票价格:开盘、收盘、盘低、盘高和成交量。然而，这个结果也缺乏实际的信号；你的网络所要做的就是产生一个类似于上次输入的价格的值。

如果我们将您的预测作为下一个预测的输入，我们会发现结果相当糟糕。我知道这种方法有一些严重的缺点。然而，我们没有使用足够的数据，这可能会限制这样一个模型的性能。

知道这个项目的缺点，最大的收获是扩展比特币或另一种加密货币的价格预测。正如常见问题部分所建议的，历史比特币数据可以从 Kaggle 下载。然后，我们在这个项目中使用的类似特征工程可以用于准备序列数据集。然而，也可以使用基于 CNN 的方法。



# 分布式深度学习——使用卷积 LSTM 网络进行视频分类

在这个项目中，我们开发了一个完整的深度学习应用程序，该应用程序对来自 UCF101 数据集的大量视频数据集进行分类。我们应用了一个组合的 CNN-LSTM 网络和**deep learning 4j**(**DL4J**)，克服了独立的 CNN 或 RNN **长期短期记忆** ( **LSTM** )网络的局限性。

最后，我们看到了如何在 AWS EC2 AMI 9.0 上跨多个设备(CPU 和 GPU)以并行和分布式的方式执行训练。我们在一个具有 8 个 GPU、32 个计算核心和 488 GB RAM 的`p2.8xlarge`实例上执行了并行和分布式训练。

本章最大的收获之一是，这个端到端项目可以被视为从视频中识别人类活动的入门。第二，我们没有达到高精度，因为我们没有用所有可用的视频剪辑训练模型。

因此，使用完整的视频数据集和超参数调整来训练网络无疑会提高准确性。在这种情况下，部署改进的模型在商业上是可能的。最后，如果你想让训练更快，配置一个 Hadoop 集群并在 GPU 和 Spark 上分发训练是可能的。



# 在 GridWorld 中使用深度强化学习

在这个项目中，我们看到了如何使用 DL4J 和充当 Q 函数的 Neural QLearning 开发一个演示 GridWorld 游戏。我们还为开发 DQN 玩 GridWorld 游戏提供了一些基本的理论背景。然而，我们没有开发一个模块来可视化整个剧集中特工的动作。我承认这是这个项目最大的缺点。然而，我在 FAQ 部分讨论了一些改进。

这个项目的收获是用可视化模型扩展这个应用程序，甚至开发其他基于 RL 的游戏，如 Doom 和 ALE 将是一个好主意。其次，也是最后，我们还可以考虑为在线交易开发另一个有趣的 RL 项目。



# 使用因子分解机的电影推荐系统

在这个项目中，我们看到了如何使用因式分解机(FMs)开发一个电影推荐系统，这是一组算法，通过以受监督的方式合并矩阵因式分解算法中不存在的二阶特征交互来增强线性模型的性能。

然而，在使用基于 RankSys 库的 FMs 进行项目实现之前，我们看到了使用矩阵分解和协同过滤的推荐系统的一些理论背景。这个项目不仅涵盖了个人用户的电影分级预测，还讨论了分级预测。因此，我们也用 FM 来预测电影的排名。

然而，我要说的是，潜在的限制是这个库不具有可伸缩性和良好的结构。因此，尝试基于 Python 的 FM 库将是一个更好的主意。最后，最大的收获是使用基于 Python 的 FM 库来扩展这个应用程序，以用于来自 MovieLens 或 IMDb 的更大的电影数据集，这是推荐的。



# 当前趋势和展望

作为一名研究人员，我是 WWW'2018、ISWC'2018、ESWC'2017/2018 和 ESWC SemDeep'2018 国际研讨会等会议的**项目委员会** ( **PC** )成员。除此之外，我还是《国际语义网杂志》、《云计算杂志》和《生物信息学简报》的客座编辑。

在回顾这些会议和期刊的大量论文时，我发现研究人员没有将自己局限于使用原始的 RNN、CNN、DBN 或自编码器开发新兴的用例及分析解决方案。他们通过将不同的领域结合起来，提出了跨越新架构的想法。



# 当前趋势

正如在[第一章](fba163f0-88c0-4278-a4a1-df5389cc3a10.xhtml)、*深度学习入门*中所讨论的，研究人员最近提出了这么多涌现的 DL 架构。这些不仅包括改进 CNN/RNN 及其变体，还包括其他一些特殊类型的架构:**深度时空神经网络** ( **DST-NNs** )、**多维循环神经网络** ( **MD-RNNs** )、**卷积自编码器** ( **CAEs** )、深度嵌入聚类等等。

然而，还有一些新兴的网络，如 CapsNets，这是一种 CNN 的改进版本，旨在消除 Hinton 等人提出的常规 CNN 的缺点。然后，我们有用于图像识别的残差神经网络和用于简单图像生成的**生成对抗网络** ( **GANs** )。

除了这些趋势和用例之外，不同的深层和新兴架构正在被用于多媒体分析；计算机视觉(尤其是语义图像分割)；物联网、图像和网络流量的异常检测；自然语言处理的神经机器翻译:以及知识图与神经网络的集成。



# 新兴数字图书馆体系结构展望

在这一小节中，我们将讨论一些新兴的架构及其变体，重点关注一些用例。



# 残差神经网络

由于数百万亿的超参数和与之相关的其他实际方面，很难训练深度神经网络。为了克服这种局限性，和等人(见的)提出了一种**剩余学习框架**(**)来简化比以前使用的网络更深层次的网络的训练。现在，根据最初的论文:**

 **在这种网络设置中，我们明确地让这些层符合一个残差映射，而不是希望每一层的堆栈都直接符合一个期望的底层映射。原始映射被重铸为 F(x)+x。我们假设优化残差映射比优化原始的、未被引用的映射更容易。在极端情况下，如果一个恒等式映射是最优的，那么将残差推到零将比通过一堆非线性层来拟合一个恒等式映射更容易。”

通过这种方式，与其他 DNN 架构相比，rnn 更容易优化，并且可以从显著增加的深度中获得精度。不足之处在于，通过简单堆叠剩余块来构建网络，不可避免地限制了其优化能力。为了克服这一限制，https://arxiv.org/abs/1608.02908 等人还提出使用多级残差网络(见[。](https://arxiv.org/abs/1608.02908)

因此，剩余网络被用于解决许多新出现的用例，包括:

*   *基于骨架的动作识别与空间推理和时间堆栈学习*(详见 https://arxiv.org/pdf/1805.02335)。
*   最近，袁等人提出了*采用空间-光谱深度残差卷积神经网络*的高光谱图像去噪方法(见【】的)。
*   *利用改进的 DRN* 进行交通流量预测的动态模型(详见 https://arxiv.org/pdf/1805.00868)
*   *利用广域剩余网络对模拟无线电信号进行分类，用于搜寻外星智能*(详见 https://arxiv.org/pdf/1803.08624)



# 甘斯

gan 是深度神经网络架构，由两个相互对抗的网络组成(因此得名对抗性网络)。伊恩·古德费勒等人在一篇论文中介绍了甘斯(详见[https://arxiv.org/abs/1406.2661v1](https://arxiv.org/abs/1406.2661v1))。GAN 是人工智能领域最好的研究成果之一，可以学习模仿任何数据分布。这就是为什么一个训练有素的 GAN 可以被用来创造与我们相似的世界，尤其是图像、音乐、语音或散文。

虽然最初的 GAN 论文的目标是简单的图像生成，如 DCGAN、BEGAN 等，但人们正在将这一思想扩展到字体生成、动漫人物生成、交互式图像生成、文本到图像生成、2D 对象生成、人体姿态估计等。一些具体的面向研究的用例概述如下:

*   用于从与 LSTM 的描述中生成图像序列(更多信息见[https://arxiv.org/pdf/1806.03027](https://arxiv.org/pdf/1806.03027)
*   **脑电图** ( **脑电图**)脑信号的生成对抗网络(详见 https://arxiv.org/pdf/1806.01875)
*   用于电子健康记录的自然语言生成(详见[https://arxiv.org/pdf/1806.01353](https://arxiv.org/pdf/1806.01353)
*   用于胸部 X 射线分割(详见[https://arxiv.org/pdf/1806.00600](https://arxiv.org/pdf/1806.00600))



# 胶囊网络

正如在[第一章](fba163f0-88c0-4278-a4a1-df5389cc3a10.xhtml)、*深度学习入门*中所讨论的，CNN 在对高质量图像进行分类方面表现良好。然而，如果图像有旋转、倾斜或任何其他不同的方向，CNN 的性能会非常差。即使是 CNN 中的池操作对位置不变性也没有太大帮助。

为了克服 CNN 的这一限制，Geoffrey Hinton 等人提出了一个突破性的想法，称为**capscene networks(CapsNet)**，它特别擅长处理不同类型的视觉刺激和编码，如姿势(位置、大小和方向)、变形、速度、反照率、色调、纹理。

在常规的 DNN 中，我们不断增加层次(更多的层次意味着更深的网络)。在 CapsNet 中，想法是在一个层中添加更多的层。这样，顶网就是一组嵌套的神经层。在 CapsNet 中，克服了 max-pooling 层的限制，代之以**协议路由(RBA)** 来捕获底层视觉信息。

可惜原论文太理论化了。因此，研究人员正试图将 CapsNet 的想法扩展到不同的人工智能和数据科学项目，包括图像分类、GAN 改进和改善基于 RL 的游戏体验。下面列出了一些使用案例示例:

*   *用胶囊进行物体定位和运动传递学习*(参见 https://arxiv.org/pdf/1805.07706)
*   *一个基于注意力的双 GRU-CapsNet 模型，用于复合实体间的上义关系检测*(详见 https://arxiv.org/pdf/1805.04827)
*   *通过胶囊网络进行脑肿瘤类型分类*(详见 https://arxiv.org/pdf/1802.10200)
*   *胶囊:生成对抗胶囊网络*(详见 https://arxiv.org/pdf/1802.06167)
*   *在高级游戏环境中使用胶囊进行深度强化学习*(详见 https://arxiv.org/pdf/1801.09597)

除了这些新兴的架构，人们正在尝试使用 GAN 架构通过 CapsNet 进行图像合成(参见[https://arxiv.org/pdf/1806.03796](https://arxiv.org/pdf/1806.03796))。研究人员还将对抗性自编码器用于基于语音的情感识别(见 https://arxiv.org/pdf/1806.02146)。最后，我建议读者从 https://arxiv.org/list/cs.AI/recent 的[中了解人工智能、机器学习和深度学习的最新趋势。](https://arxiv.org/list/cs.AI/recent)



# 语义图像分割

图像分割是将图像分割成几个连贯部分的方法，但是*没有*任何理解这些部分代表什么的尝试。另一方面，语义分割试图将图像划分成语义上有意义的部分，并将每个部分分类到预定类别之一。

将原始脑图像语义分割成灰质、白质和脑脊液有助于基于分割区域对它们进行分类。基于深度学习的技术正在使用，并且非常成功，例如**栈式去噪自编码器** ( **SDAE** )。

然而，基于递归的完全卷积网络正被用于高分辨率遥感图像的语义分割(更多信息见[https://arxiv.org/pdf/1805.02091](https://arxiv.org/pdf/1805.02091))。这种类型的图像分割正在用于新兴的用例，如骨盆磁共振图像分析、自动驾驶汽车的物体检测、地理空间图像分类(见[http://www . semantic-we b-journal . net/system/files/swj 1862 . pdf](http://www.semantic-web-journal.net/system/files/swj1862.pdf))等等。



# 用于聚类分析的深度学习

聚类分析是应用最广泛的数据驱动任务之一。迄今为止，现有的聚类分析技术使用经典的聚类算法，如 k-means、二分法 k-means 或高斯混合模型。特别是，k-means 聚类算法及其几种变体已经被提出来解决高维输入空间的问题。

然而，它们基本上限于线性嵌入。因此，他们不能模拟非线性关系。然而，这些方法中的微调仅基于集群分配强化损失。因此，无法实现细粒度的聚类准确性。

简而言之，相对较少的研究集中在基于深度学习的表示学习和聚类分析上。然而，k 均值的质量取决于数据分布。深度架构可以帮助模型学习从数据空间到低维特征空间的映射，在低维特征空间中，它迭代地优化聚类目标。

考虑到这些限制和动机，研究人员提出了基于深度学习的聚类技术，用于聚类非常高维的数据和非线性对象。在这些方法中，k-means 与深度架构相结合，其中聚类-分配-硬化损失(来自 k-means)和重建损失(来自 DNN)被同时优化。这些方法包括:

*   *谢等人*(见【】的)聚类分析的无监督深度嵌入
*   *基于神经网络的聚类，使用 Hsu 等人的成对约束*(更多信息请参见的)
*   *刘等人的判别增强聚类(T1)【http://dataclustering.cse.msu.edu/papers/boost_cluster.pdf】(详见)*
*   *埃利等人的《深度学习聚类:分类学和新方法*》(更多内容请参见 https://arxiv.org/abs/1801.07648)
*   *卡里姆等人的用于基因型聚类和种族预测的递归深度嵌入网络*(详见 https://arxiv.org/pdf/1805.12218.pdf)



# 常见问题(FAQ)

我们分析了已完成的项目，并研究了最近的趋势。基于这些，你可能会有几个问题。在本节中，我将尝试设计一些这样的问题，并提供示例答案:

1.  在这一章中，我们认为使用氮化镓，我们可以解决许多研究问题。DL4J 中有 GAN 实现吗？
2.  在这一章中，我们讨论了使用 CapsNet 处理不同形状和方向的图像是一个更好的主意。DL4J 中有 CapsNet 的实现吗？
3.  在[第一章](fba163f0-88c0-4278-a4a1-df5389cc3a10.xhtml)、*深度学习入门*中，我们讨论了 DBNs 和受限玻尔兹曼机器作为它们的基本构建模块。然而，我们没有在任何已完成的项目中使用 DBNs。这是什么原因呢？
4.  在本章中，我们认为使用物联网传感器数据或图像的无监督异常检测是一种新兴的研究用例。DL4J 中有这样的例子吗？
5.  有没有用 DL4J 开发推荐引擎的例子？

6.  考虑到现在的智能手机功能非常强大，我们可以在智能手机上开发图像/物体检测应用程序吗？
7.  我如何将深度学习应用程序包装成 web 应用程序？
8.  我在运行项目时遇到了问题。此外，我在配置开发环境时遇到了一些问题(例如，关于 Eclipse/IntelliJ IDEA 和配置 CUDA/CuDNN)。我能怎么做呢？



# 问题的答案

**回答** **问题 1** :这个有一个不活跃的问题。有兴趣的读者可以看看[https://github . com/deep learning 4j/deep learning 4j/issues/1737](https://github.com/deeplearning4j/deeplearning4j/issues/1737)了解一下目前的更新情况。然而，讨论循环并不十分活跃。

**回答** **问题 2** :据我所知，DL4J 中没有 CapsNet 实现。此外，我没有看到任何关于这个话题的公开讨论/问题。我在 DL4j Gitter 频道问了但是没人回复。

**问题 3 的答案**:无监督的预训练和有监督的微调都可以使用 DBN 来执行。这意味着，如果我们没有足够的标记数据，但仍然希望执行基于神经网络的训练，这种概率网络是一种智能的选择。

**对问题 4** 的回答 **:是的，有一个使用具有重构概率的变分自编码器对 MNIST 数据进行异常检测的例子。在[https://github . com/deep learning 4j/DL4J-examples/tree/master/DL4J-examples/src/main/Java/org/deep learning 4j/examples/unsupervised/anomaly detection](https://github.com/deeplearning4j/dl4j-examples/tree/master/dl4j-examples/src/main/java/org/deeplearning4j/examples/unsupervised/anomalydetection)看一下 DL4J 的例子。然而，这个例子也可以扩展到其他数据集。**

**问题 5 答案**:这个链接有一个衣冠楚楚推荐引擎的例子[https://deep learning 4j . org/welldressed-recommendation-engine](https://deeplearning4j.org/welldressed-recommendation-engine)。

**问题 6 答案**:深度学习和神经网络也可以部署在 Android 设备中。更多信息，请参考 https://deeplearning4j.org/android 的[。](https://deeplearning4j.org/android)

**问题 7 的答案**:一旦神经网络被训练好，网络就可以用于推理，或者对它看到的数据进行预测。推理恰好是一个计算量少得多的过程。然后，可以使用 Spring Boot 或其他框架将应用程序包装成 web 应用程序。参见 https://deeplearning4j.org/build_vgg_webapp 的[的一些指南。](https://deeplearning4j.org/build_vgg_webapp)

对问题 8 的回答:你应该按照我在章节中提供的指示去做。此外，这本书的代码可以在 GitHub 上获得，所以请随意公关或创建新的问题，我会尽快尝试修复它们。关于任何新的问题，你可以通过 https://gitter.im/deeplearning4j/deeplearning4j 的[DL4J Gitter 直播频道询问。](https://gitter.im/deeplearning4j/deeplearning4j)**