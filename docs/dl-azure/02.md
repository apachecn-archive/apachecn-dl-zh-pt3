# 2.深度学习概述

在第 [1](01.html) 章中，我们对 AI 和深度学习背后的基本思想进行了概述。我们讨论了深度学习(应用具有大量层的人工神经网络模型)如何为几个研究领域产生最先进的结果，如图像分类、对象检测、语音识别和自然语言处理。

深度学习在医疗保健、制造和零售等领域的许多应用中也显示出了前景。例如，在 2017 年，一个人工智能系统在识别皮肤癌方面做得和皮肤科医生一样好，一个模型可以比心脏病专家更好地从单导联心电图(ECG)信号中诊断出不规则的心律(Esteva 等人，2017；Rajpurkar、Hannun、Haghpanahi、Bourn 和 Ng，2017 年)。我们相信这一趋势将继续下去:深度学习将为许多行业的更多场景带来价值，改善人工智能体验的进展将继续加快。

在这一章中，我们将简要介绍几种常用网络的基本知识。我们还描述了深度学习项目的数据科学工作流，包括数据科学家和开发人员在从事深度学习项目时需要开始使用的一些流行工具和技术的描述。本章还提供了开始深度学习项目的实用技术，无需花费大量时间从头开始使用 ImageNet 等大型数据集训练卷积神经网络。

本章只是对深度学习和开发基于深度学习的解决方案的构建模块的概述。在本书的第三部分，这些基本概念是建立在更详细地介绍几种常见的网络模型。后面的章节(例如第 [6](06.html) 章)提供了可以遵循的示例代码。虽然本章也涵盖了深度学习模型训练和评分的基本思想，但我们在本书的第四部分讨论了更多细节以及在 Azure 上训练和评分的样本代码。

## 常见网络结构

人工神经网络模型有许多变体，包括卷积神经网络(CNN)、递归神经网络(RNNs)、生成对抗网络(GANs)和自动编码器，例如，如表 [2-1](#Tab1) 所示。如今，大多数问题都需要数据科学家为手头的问题选择合适的网络类型和网络结构。数据科学家花时间尝试不同的问题公式和探索不同的超参数(例如，网络结构的类型)，并查看哪种方法适用于他们的特定问题。在接下来的章节中，我们将简要介绍每种类型的网络结构。

表 2-1

常见网络结构和常见应用

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"> <col class="tcol4 align-left"></colgroup> 
| 

国家实验室认可

 | 

我们走吧

 | 

甘斯

 | 

自动编码器

 |
| --- | --- | --- | --- |
| 图像分类、目标检测 | 自然语言处理，时间序列分析 | 文本到图像的创建，图像到图像的翻译 | 降维、异常检测、推荐系统 |

### 卷积神经网络

CNN 是简单的神经网络，至少在其中一层使用卷积算子。CNN 是前馈神经网络模型，是特别用于计算机视觉问题的基础网络。前馈意味着网络中的信息总是向一个方向输送，网络结构中没有任何环路。CNN 还被用于其他领域，例如用于某些任务的语音识别和自然语言处理。

CNN 工作在平移不变性的前提下；对于图像来说，这建立在图像中的一个对象即使被移动也是同一个对象的想法上，如图 [2-1](#Fig1) 所示。这很重要，因为网络不必重新学习图像的每个位置中的每个对象是什么。这需要明显更少的数据来训练，并且可以更好地概括为学习如何处理图像，而不是像多层感知器(MLP)中需要的那样，我们必须单独学习如何识别每个位置的对象。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig1_HTML.png](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig1_HTML.png)

图 2-1

CNN 允许翻译差异；例如，即使手写数字“8”在图像中移动，它仍然是 8。这个概念有助于网络学习如何更有效地处理图像，而不是简单地应用带有隐藏层的普通神经网络模型。

例如，如果我们希望模型能够学习识别什么是猫，无论猫位于图像中的什么位置，它都具有模型应该学习的相同特征:如何识别皮毛、猫耳朵、尾巴等等。

在 CNN 中，输入图像通过通常被称为过滤器或内核的东西进行馈送，过滤器或内核充当网络中的特征检测器。您可以将这些特征检测器视为试图学习图像中的边缘、形状或模式等方面。这是通过将特征检测器通过滑动窗口一次应用于图像的一个片上来实现的，并且该卷积操作的结果被保存到所谓的卷积图像或特征图中。如前所述，CNN 具有平移不变性，因为滤波器共享应用于每个图像补片的相同权重，在应用之后形成卷积图像。神经网络中卷积层的深度对应于该层中使用的滤波器数量。

通过使用池层的一种形式的下采样被用于减少通过的数据的大小，并移除网络在该阶段已经学会作出反应的潜在冗余方面。例如,“最大池”层简单地从图像的每个窗口的卷积图像的输出中取最大值，如图 [2-2](#Fig2) 所示，其中跨距表示窗口跳跃的像素数。卷积层和池层在许多组合中使用，将输入图像转换为数组，然后输入到至少一个完全连接的层，该层输出到预测的输出类，如图 [2-3](#Fig3) 所示。完全连接的层仅充当预测输出类的分类器。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig2_HTML.png](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig2_HTML.png)

图 2-2

最大池操作，2 乘 2 过滤器，跨距为 2

换句话说，CNN 在概念上可以分为两个主要部分，两者都可以一起优化:

1.  **自动特征提取器**创建隐藏特征状态——代表与分类相关的图像方面的特征——并由卷积层和池层等层组成。

2.  **分类器**是一个全连接的神经网络，由至少一层组成，对隐藏特征状态进行分类。

CNN 的自动特征提取器部分使网络能够学习诸如图像的边缘和形状等方面，而不必像使用诸如尺度不变特征变换(SIFT)等算法那样对网络进行显式编程来计算这些特征。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig3_HTML.png](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig3_HTML.png)

图 2-3

卷积神经网络(CNN)的基本构件

重要的是，CNN 通过使用称为反向传播的概念在大量标记数据上训练网络，自动学习过滤器(“特征检测器”)的值，继续提高网络内的权重，直到分类误差最小化。在网络的早期层中，网络通常创建过滤器，这些过滤器看起来识别图像的各个方面，例如边缘、基本形状和颜色。后面的层学习越来越复杂的模式，直到所有这些模式放在一起可以帮助网络学习输入的分类。

有许多方法可以将卷积层、池层和全连接层的基本构建模块与 CNN 的其他方面结合起来，例如 stride(滤波器在图像上滑动的像素数)、dropout(用于减少过拟合)以及将非线性引入网络并处理每层输出的激活函数类型。也有许多方法来训练和规划网络，许多研究都集中在如何设计层、连接以及深度与宽度等方面。更多的细节和样本代码可以在第 [6](06.html) 章中找到，因此我们只简要描述深度学习概述所需的基础知识，以及了解将在第[3](03.html)T4】章中讨论的与 CNN 相关的一些趋势。

### 递归神经网络

rnn 直接利用顺序信息。传递到网络的序列可能在输入、输出中，或者甚至在两者中。RNN 通过有时被称为“状态”或“内存”的东西来处理数据序列与作为前馈网络的 CNN 不同，rnn 在网络结构中包含环路，如图 [2-4](#Fig4) 和图 [2-5](#Fig5) 所示。然而，请注意，CNN 也越来越多地被证明对分析序列信息有用，这在第 [7](07.html) 章中有更详细的描述。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig5_HTML.png](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig5_HTML.png)

图 2-5

rnn 通过序列处理信息。通常，该序列表示随时间变化的信息，从而可以“展开”RNN 中的循环，以查看给定时间点的输出是先前时间点的输入的函数。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig4_HTML.png](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig4_HTML.png)

图 2-4

递归神经网络在网络结构中有一个环路，并通过序列处理数据

RNNs 已经在许多自然语言处理任务中取得了成功，因为句子中一个单词的含义依赖于它周围的其他单词。rnn 在其他应用中也很有用，例如时间序列预测、语音识别和手写识别。

“标准”RNN 通过在每一步应用递归公式，用单个“隐藏”向量来处理向量序列。该公式采用当前向量和先前状态。已经提出了 RNNs 的变体，其能够更好地处理更长的序列，例如长短期记忆网络(LSTMS)。关于 RNNs 的更多细节以及示例代码可以在第 [7](07.html) 章中找到。

在图 [2-6](#Fig6) 中，CNN 和 RNNs 的应用示例显示了在 PowerPoint 文件中粘贴的图像的 alt 文本中自动生成图像描述。CNN 用于对图像中的对象进行分类，RNNs 用于基于这些对象生成句子描述。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig6_HTML.jpg](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig6_HTML.jpg)

图 2-6

通过使用 CNN 和 rnn，在 PowerPoint 中为图像自动创建图像描述

### 生成对抗网络

GANs 是深度学习的最新发展，它通过训练两个相互竞争的独立网络模型来解决给定的问题(Goodfellow 等人，2014 年)。近年来，GANs 显示出巨大的潜力，并已应用于各种场景，从图像合成、提高图像质量(超分辨率)、图像到图像的翻译、文本到图像的生成等等。此外，gan 是在将 AI 用于艺术、音乐和创意(例如，音乐生成、音乐伴奏、诗歌生成等)方面取得进步的基础。).

甘正在成为无监督和半监督学习的强大技术。基本的 GAN 包括以下内容:

*   **生成模型**(即生成器)生成一个对象。生成器对真实对象一无所知，通过与鉴别器交互来学习。例如，生成器可以生成图像。

*   **判别模型**(即判别器)判断一个物体是真的(通常用接近 1 的值表示)还是假的(用接近 0 的值表示)。

*   鉴别器向生成器提供对抗损失(或错误信号),使得生成器能够生成尽可能接近真实对象的对象。

更多关于 GANs 的细节和示例代码章节 [8](08.html) 包含在内。

我们预计 GANs 将在未来几年变得更受欢迎，甚至超出创造性应用的使用，因为它们有潜力解决如何创建无监督学习方法，这将大大扩展 ML 应用的范围。今天，这些类型的模型需要很长时间来训练，并且众所周知很难调整，我们希望研究将继续推进这些网络在实际应用中的实用性。随着这种技术在现实世界中的应用越来越多，质量不断提高，并扩展到更多的媒体，如视频，我们相信更多的争论将会出现在它们的使用上。例如，无法辨别真实内容和虚假内容的影响非常深远，媒体已经强调了一些例子，如政治家讲话视频中插入的近乎真实的虚假文字(Metz & Collins，2018)。

### 自动编码器

自动编码器是另一种类型的前馈网络，已经用于诸如降维、异常检测和学习生成模型之类的应用。这些神经网络模型有一个输入层、一个输出层和至少一个介于两者之间的隐藏层。重要的是，自动编码器在输入层中具有与输出层相同数量的单元，因此它们的目的是在输入层中重建原始值。当然，这些是以这样的方式设计的，即它们不精确地复制输入数据，而是受到限制，使得它们只能近似地学习，例如具有比输入数据更小的维度。因此，自动编码器学习最相关的属性来重构输入数据。因此，对于没有预测目标值的无监督学习应用程序，或者对于输入到另一个算法的学习特征，它们可能很有用。它们已经显示出在推荐系统等许多应用中的前景(Kuchaiev & Ginsburg，2017)。

## 深度学习工作流程

对于许多人工智能项目，深度学习技术经常被用作构建创新解决方案的构建模块，这些解决方案从图像分类和对象检测到图像分割、图像相似性和文本分析(例如，情感分析、关键短语提取)。通常，人们会问:“我如何开始在我的团队中使用深度学习？”要开始深度学习，了解深度学习项目中使用的工具和技术以及构建解决方案的工作流程非常重要。

鉴于创新解决方案的业务需求，数据科学家需要将其映射到一个或多个深度学习任务。例如，假设一家零售企业希望为移动设备创建端到端的客户购物体验，客户可以拍摄一件衬衫或一件连衣裙的照片，然后在移动设备上运行的应用程序可以将其与购物目录中的衬衫和连衣裙进行匹配。为了实现这一点，数据科学家将其映射到一个图像相似性问题:获取一个新的输入图像，并将其与目录中的所有衬衫和连衣裙进行匹配。前 *N* 幅图像将被返回给移动应用程序。在与应用程序开发人员一起工作时，还需要解决其他需求，例如，识别和裁剪图像，只显示穿着衬衫或裙子的人。这将需要使用对象检测和图像分类。

一旦确定了深度学习任务，典型的深度学习工作流程将包括以下内容:

1.  确定相关的数据集。

2.  预处理数据集。

3.  训练模型。

4.  检查模型的性能。

5.  调整模型。

6.  部署模型。

7.  迭代并收集更多数据，以实现再训练。

### 查找相关数据集

大多数想要开始深度学习项目的公司在试图找到相关数据集时往往面临困难，这些数据集可以用于为特定的商业场景训练他们的深度学习模型。此外，数据集需要被标记。例如，为了训练 CNN 识别衣服的类型(例如，polo 衫、t 恤衫、连衣裙、牛仔裤)，需要由衣服的图像组成的数据集，该数据集具有指示图像是衬衫、连衣裙、t 恤衫还是牛仔裤的标签。这些图像可以来自现有的产品目录、公共图像数据集(例如，来自 ImageNet、CIFAR-10、Deep Fashion 的各种图像集)，以及从各种网站搜集的图像。

如果数据不可用，为了播种初始训练和验证数据集，数据科学家通常使用搜索引擎(图 [2-7](#Fig7) )对特定类别(例如牛仔裤)执行图像搜索，其中图像所有者已将图像标记为可免费用于商业用途。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig7_HTML.jpg](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig7_HTML.jpg)

图 2-7

使用 Bing 搜索图片返回的结果

### 数据集预处理

在数据科学家获得相关的图像数据集后，他或她需要为培训做准备。很多现实世界的图像数据集往往是不平衡的(俗称*小众类问题*)。这意味着特定类别可能有更多的图像(例如，polo 衫)，而另一个类别可能有更少的图像(例如，t 恤衫)。为了解决不平衡的数据集问题，数据科学家应用各种技巧来增加少数类中的图像数量，或者从更频繁的类中向下采样，直到实现奇偶校验。

另一种常用的预处理技术是数据扩充，以帮助模型在多种条件下进行概括，从而提高其对旋转、平移和缩放等方面的不变性。这包括对图像应用各种变换，如缩放、旋转、随机裁剪图像、翻转图像、调整亮度和对比度等。不同的深度学习框架支持各种数据增强功能。

### 训练模型

数据集经过预处理和准备后，数据科学家就可以开始设计深度学习模型架构和训练模型了。实现深度学习模型的有效建模和训练的关键因素是(1)选择深度学习工具包，以及(2)使用 GPU 等硬件进行训练。这将在本章的下一节详细讨论。

根据数据集的大小，可以在本地机器(如笔记本电脑、PC、Mac)上或使用公共云中可用的基础架构(如 Microsoft Azure)来训练模型。Azure 提供了带有 Nvidia GPUs 的 NC 系列虚拟机(VM ),以及一项名为 Azure Batch AI 的托管服务，使您能够轻松地扩展和缩减深度学习工作所需的 GPU。这将在第 [4](04.html) 章和第 [9](09.html) 章中详细介绍。

### 验证和调整模型

在深度神经网络的训练期间，有几个关键指标将提供关于每个时期的学习效率和模型质量的见解。一个*时期*指的是训练数据集的一次完整通过。通常跟踪两个度量:(1)损失函数，以及(2)训练和验证准确性。

通过在每个时期评估*损失函数*，可以评估每个时期结束时的模型质量。较低的损失是更好的模型的良好指示。甚至在学习过程开始之前就已经设置了许多超参数-学习率是一个重要的超参数，它会对模型的结果产生重大影响。通过绘制 loss (y 轴)和 epochs (x 轴),可以了解学习率是否设置得合适:好的学习率导致在更短的时间内损失更低。通常，对训练和验证数据集都跟踪学习率。但是，确保模型没有过度拟合训练数据也很重要。图 [2-8](#Fig8) 显示了不同学习率的示例。实际上，学习率曲线并不平滑，可以根据需要在训练过程中修改学习率。这只是在训练深度学习模型的过程中所需的验证和调整类型的一个例子。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig8_HTML.jpg](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig8_HTML.jpg)

图 2-8

学习率不同。插图灵感来自斯坦福 cs231n 课程，可在 [`http://bit.ly/StanfordCS231n`](http://bit.ly/StanfordCS231n) 获得。

通常跟踪的第二个指标是*培训和验证准确性*。通过绘制精度(y 轴)和时期(x 轴)的图表，可以了解模型是否过拟合训练数据集。如果训练和验证准确度曲线彼此接近，则很少发生过拟合。如果训练曲线和验证曲线相距甚远，则表示过度拟合，重新访问模型很重要，因为它不会像预期的那样推广到新数据。图 [2-9](#Fig9) 显示了如何通过查看训练和验证数据集的精度曲线来识别过度拟合。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig9_HTML.jpg](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig9_HTML.jpg)

图 2-9

使用训练和验证准确性识别过度拟合

### 部署模型

一旦模型的质量足够满足解决方案的需求，下一步就是部署它。如今，深度学习模型可以作为 REST APIs 部署到云，按计划批量运行，部署到移动设备(如 iPhones、Android 手机、iPads 等)或边缘设备(如物联网[IOT]网关)。这取决于你如何考虑使用经过训练的深度学习模型。例如，如果您正在开发一个 web 应用程序，并且您正在用 AI 丰富它，那么将您的深度学习模型作为 REST APIs 来操作是有意义的，它可以很容易地被 web 应用程序使用。如果您正在开发一个移动应用程序，您应该考虑连接和断开连接的场景，以及延迟需求。您要么让模型在移动设备上离线运行，要么使用混合模型，既有在设备上运行的模型组合，又有在云中提供更强大功能的 REST APIs。

要将深度学习模型部署为 REST APIs，有几种选择。你可以利用 Azure 机器学习操作化服务(更多细节将在本书的后续章节中介绍)在 docker 容器中托管模型，并公开一个或多个 REST 端点，或者你可以构建自己的托管堆栈(例如，使用 Flask，由 NGINX 等高性能 web 服务器支持的 CherryPy)。您也可以在 Microsoft Azure 上轻松部署这个托管堆栈。根据不同的场景，您可能希望按计划对大量数据以批处理模式运行模型。GPU 等硬件的类型也是一个需要考虑的相关因素。更多细节将在第 [10 章](10.html)中讨论。

关于处理数据科学工作流的更多考虑，包括深度学习项目，我们建议在 [`http://bit.ly/MSFT_TDSP`](http://bit.ly/MSFT_TDSP) 使用微软团队数据科学流程。这包括数据科学生命周期概述、建议的标准化项目结构和基础架构，以及数据科学项目资源。

### 深度学习框架和计算

如前所述，执行深度学习训练需要的两个关键因素是(1)使用深度学习框架，以及(2)使用 GPU 执行训练。通过 CUDA 和 OpenCL 等框架，GPU 上的通用计算(尤其是通过有效使用矩阵乘法)得到了加速。这些使得 CUDA 之上的 cuDNN 等更高级别的库能够用于构建深度神经网络；cuDNN 支撑着流行的深度学习库。

现在有很多流行的深度学习框架，比如 Tensorflow、PyTorch、CNTK、MXNet、Caffe2，还有流行的更高级别的 API，比如 Keras、Gluon。深度学习工具包的选择取决于许多因素，包括良好的教程和模型架构和预训练模型的现有实现的可用性，公司中人工智能人才的技能集，工具包在表达复杂的深度神经网络方面的灵活性，内置助手功能的可用性(例如，丰富的数据扩充和转换 API 集)，有效利用 CPU 和 GPU 的能力，以及执行分布式训练的能力。

我们推荐在 [`http://bit.ly/DLComparisons`](http://bit.ly/DLComparisons) 可用的深度学习比较报告，用于了解不同深度学习框架在一些常见场景上的差异，示例框架如图 [2-10](#Fig10) 所示。该回购有几个既定目标:

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig10_HTML.jpg](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig10_HTML.jpg)

图 2-10

我们推荐在 GitHub[`http://bit.ly/DLComparisons`](http://bit.ly/DLComparisons)上提供的用于深度学习框架的“Rosetta Stone ”,以及可用于运行深度学习代码的 Azure GPU 虚拟机的不同变体的计时

1.  深度学习框架的“罗塞塔石碑”,允许数据科学家轻松地将他们的专业知识从一个框架转移到另一个框架。

2.  使用最新的最高级别 API 优化 GPU 代码。

3.  跨 GPU 比较的通用设置(可能是 CUDA 版本和精度)。

4.  跨语言比较的通用设置(Python，Julia，R)。

5.  验证自己安装的预期性能的可能性。

6.  不同开源社区之间的协作。

回购中的比较并不意味着对不同框架的整体表现提出任何建议，因为它们省略了重要的比较，例如预训练模型的可用性，这只是一个例子。然而，它们是一种很好的入门方式，可以用来比较许多常见场景的流行框架。

### 注意

Keras 正在成为一个受欢迎的深度学习库，因为它能够提供用于建模深度神经网络的高级抽象，以及选择不同后端的灵活性(例如，TensorFlow，CNTK，Theano)。

例如，2017 年，脸书和微软宣布了深度学习模型的 ONNX 开源格式，使数据科学家能够在一个框架中训练一个模型，但在另一个框架中部署它。自宣布以来，其他公司和流行框架的开发者也加入了这一开源互操作性标准的努力，以在框架之间转移深度学习模型。也有一些包允许直接从一个框架转换到另一个框架，比如 MMdnn，它帮助用户直接在不同的框架之间转换，并可视化模型架构。

许多深度学习库也包括各种 ML 算法。这些深度学习库大多数都支持分布式训练，这对大规模进行深度学习有很大帮助。大多数深度学习库都有 Python 包装器。如果你是一个 R 用户，你也可以使用一些深度学习库的 R 接口(例如 TensorFlow、微软认知工具包[CNTK]、Keras 等的 R 接口)。在本书中，我们将重点放在使用这些库来建模深度神经网络。图 [2-11](#Fig11) 展示了几个深度学习库，以及 GitHub 上的代码活动。

![../images/463582_1_En_2_Chapter/463582_1_En_2_Fig11_HTML.jpg](../images/463582_1_En_2_Chapter/463582_1_En_2_Fig11_HTML.jpg)

图 2-11

深度学习库的 GitHub Stars/Fork

虽然本书中的大部分例子使用了 Tensorflow，但是微软 AI 平台支持任何开源框架。此外，我们还包括一些使用其他框架的示例，例如一个教学示例，展示了如何使用第 [9](09.html) 章中的微软 Batch AI 服务，使用许多不同的深度学习框架来训练 CNN 模型。

GPU 使得深度学习模型的训练在合理的时间框架内成为可能。近年来，算法和更快 GPU 的可用性两方面的创新使得深度学习模型的训练能够快速完成。例如，在 2017 年之前，使用公开可用的 ImageNet 数据集训练像 ResNet-50 这样的 CNN 需要 14 天或更长时间。在 2017 年的几个月内，训练 ResNet-50 所需的时间大幅减少，从一小时减少到约 15 分钟。例如，Preferred Network 在 2017 年 11 月能够用 1024 个 P100 GPU 在 15 分钟内用 ChainerMN 训练 ResNet-50 CNN 模型。

### 快速启动深度学习:迁移学习和领域适应

启动深度学习解决方案的一个主要趋势是将先验知识构建到模型的开发中，这样它就不会只从手头问题的数据中学习。实现这一点的两种常见方式是通过在计算机视觉中称为迁移学习的概念，以及主要通过在自然语言处理中使用单词嵌入的领域适应。

迁移学习在图像分类和物体检测等计算机视觉任务中特别有用。基本的想法是，我们希望能够将我们的学习从一个应用程序转移到另一个应用程序。迁移学习使数据科学家能够快速调整现有的预训练模型(例如，AlexNet、ResNet-50、InceptionV3 等)。)到新的领域。例如，CNN 可以在具有数百万个示例的大型 ImageNet 数据上进行训练。然后，这个 CNN 在内部保存如何很好地处理图像的表示，例如如何检测边缘、形状和模式以区分对象。因此，我们希望能够使用这种在网络权重中捕获的知识，在数据明显较少的分类场景中使用，例如，通过在制造装配线上拍摄的图像来区分零售网站上的衬衫类型或区分有缺陷和无缺陷。

因此，为了启动计算机视觉中的深度学习项目，例如，我们建议数据科学家利用使用公共可用数据集(如 ImageNet、CIFAR-10 和 COCO)训练的预训练模型。这些数据集包含数百万张图片(来自不同的领域)，并由各自的研究实验室精心管理(通常通过众包工作)，并标注了类别标签。

预训练的模型用于快速启动图像分类、对象检测和图像分割问题。这些在大型图像数据集上训练的预训练模型，或者被用作新图像的特征，或者被进一步微调以适应特定领域的图像(例如，医学 x 射线图像、PCB 电路板图像等)。)来提高预测的质量。表 [2-2](#Tab2) 显示了不同类型的迁移学习。表 [2-3](#Tab3) 显示了每种迁移学习所需的输入和输出初始化。

表 2-3

使用迁移学习初始化深度学习模型的输入和输出

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"></colgroup> 
| 

类型

 | 

如何初始化特征图层

 | 

输出层初始化

 |
| --- | --- | --- |
| 标准 DNN | 随意 | 随意 |
| 无头 DNN | 学习使用另一个任务 | 分离 ML 算法 |
| 微调 DNN | 学习使用另一个任务 | 随意 |
| 多任务 DNN | 随意 | 随意 |

表 2-2

不同类型的迁移学习

<colgroup><col class="tcol1 align-left"> <col class="tcol2 align-left"> <col class="tcol3 align-left"></colgroup> 
| 

类型

 | 

迁移学习是如何使用的？

 | 

怎么训练？

 |
| --- | --- | --- |
| 标准 DNN | 没有人 | 联合训练特征化和输出 |
| 无头 DNN | 使用在相关任务中学到的功能 | 使用这些特征来训练单独的分类器 |
| 微调 DNN | 使用和微调在相关任务中学习到的功能 | 以较小的学习速率共同重新训练特征和输出 |
| 多任务 DNN | 习得的特征需要解决许多相关的任务 | 在两个任务之间共享一个特性化网络 |

自然语言处理也通过预训练模型得到了加速，但在这种情况下，通常是在单词表示的训练中进入被称为单词嵌入的深度学习模型。退一步说，在自然语言处理中，单词通常通过一键编码来表示，其中每个单词由长度等于词汇表大小的向量来表示；除了词汇表中对应于该单词的位置(值为 1)之外，所有值都为零。模型每次都需要从手头的问题数据开始学习，以理解如何处理单词以及它们在特定自然语言处理任务的上下文中的含义。相反，单词嵌入是编码单词语义的低维向量，在嵌入向量空间中编码彼此接近的语义相关的单词。

重要的是，单词嵌入可以在大的未标记数据上训练，并且许多预训练的单词嵌入可用于其他自然语言处理任务。通过使用预先训练的单词嵌入，例如在谷歌新闻上训练的单词嵌入，关于单词如何彼此相关的知识被嵌入到用它们建立的模型中。

使用所谓的 word2vec 算法(如 Skip-Gram 和 CBOW)来学习单词嵌入向量。这些是简单的神经网络模型，旨在预测每个单词周围窗口中的单词。这个概念是语义相关的单词将出现在相似的上下文中，从而获得相似的向量表示。当然，特定领域的单词嵌入可能有利于在模型中更好地表示单词，最近的研究也集中在如何在自然语言处理应用程序之间实现更好的领域适应。

### 模型库

许多预训练的深度神经网络可用于每个深度学习库。例如，微软 CNTK 和 TensorFlow 为几个最先进的 CNN(Alex net、GoogLeNet、ResNet 和 VGG)提供了预训练模型。Caffe 的模型动物园为最先进的 CNN (ResNet，Inception，VGG 等)提供了丰富的 40 多个预训练模型。)，并支持各种场景(例如，汽车模型识别、识别不同的地标和地点、场景识别等。).Google Word2Vec 是一个流行的预训练单词嵌入模型，有许多可用的教程。

你可以使用这些预训练的模型来启动你的深度学习项目，或者根据你的业务场景进一步微调网络。这通常会节省大量在不同数据集上训练基本模型的时间。

### 更多信息

了解有关预训练模型示例的更多信息:

CNTK 预训练图像模型: [`http://bit.ly/CNTKModels`](http://bit.ly/CNTKModels)

TensorFlow 官方模型: [`http://bit.ly/TensorflowModels`](http://bit.ly/TensorflowModels)

咖啡馆模型动物园: [`http://bit.ly/CaffeModels`](http://bit.ly/CaffeModels)

tensorlow word 2vec:[`http://bit.ly/TensorflowWord2Vec`](http://bit.ly/TensorflowWord2Vec)

## 摘要

本章简要介绍了几种常见的神经网络类型，包括 CNN、RNNs 和 GANs，在后面的章节中会结合示例代码对其进行更详细的讨论。我们还讨论了深度学习工作流、启动深度学习项目的具体细节以及一些可用于开发和训练深度神经网络的库。为了帮助启动深度学习项目，数据科学家和开发人员可以利用预训练的模型作为特征图像的基础，或者使用它们来进一步定制和微调，以适应您的业务领域。在下一章中，我们将讨论深度学习领域的一些趋势以及这种建模方法的一些限制。